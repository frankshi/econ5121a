<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Asymptotic Properties of Least Squares | Econ5121</title>
<meta name="author" content="Zhentao Shi">
<meta name="description" content="We have learned some basic asymptotic theory in the previous chapter. We apply these results to study asymptotic properties of the OLS estimator \(\widehat{\beta}=\left(X'X\right)^{-1}X'Y\), which...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="7 Asymptotic Properties of Least Squares | Econ5121">
<meta property="og:type" content="book">
<meta property="og:description" content="We have learned some basic asymptotic theory in the previous chapter. We apply these results to study asymptotic properties of the OLS estimator \(\widehat{\beta}=\left(X'X\right)^{-1}X'Y\), which...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Asymptotic Properties of Least Squares | Econ5121">
<meta name="twitter:description" content="We have learned some basic asymptotic theory in the previous chapter. We apply these results to study asymptotic properties of the OLS estimator \(\widehat{\beta}=\left(X'X\right)^{-1}X'Y\), which...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Alice-0.4.1/font.css" rel="stylesheet">
<link href="libs/_DM%20Mono-0.4.1/font.css" rel="stylesheet">
<link href="libs/_Montserrat-0.4.1/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Econ5121</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preface</a></li>
<li><a class="" href="probability.html"><span class="header-section-number">2</span> Probability</a></li>
<li><a class="" href="conditional-expectation.html"><span class="header-section-number">3</span> Conditional Expectation</a></li>
<li><a class="" href="least-squares-linear-algebra.html"><span class="header-section-number">4</span> Least Squares: Linear Algebra</a></li>
<li><a class="" href="least-squares-finite-sample-theory.html"><span class="header-section-number">5</span> Least Squares: Finite Sample Theory</a></li>
<li><a class="" href="basic-asymptotic-theory.html"><span class="header-section-number">6</span> Basic Asymptotic Theory</a></li>
<li><a class="active" href="asymptotic-properties-of-least-squares.html"><span class="header-section-number">7</span> Asymptotic Properties of Least Squares</a></li>
<li><a class="" href="asymptotic-properties-of-mle.html"><span class="header-section-number">8</span> Asymptotic Properties of MLE</a></li>
<li><a class="" href="hypothesis-testing.html"><span class="header-section-number">9</span> Hypothesis Testing</a></li>
<li><a class="" href="panel-data.html"><span class="header-section-number">10</span> Panel Data</a></li>
<li><a class="" href="endogeneity.html"><span class="header-section-number">11</span> Endogeneity</a></li>
<li><a class="" href="generalized-method-of-moments.html"><span class="header-section-number">12</span> Generalized Method of Moments</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/zhentaoshi/Econ5121A">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="asymptotic-properties-of-least-squares" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Asymptotic Properties of Least Squares<a class="anchor" aria-label="anchor" href="#asymptotic-properties-of-least-squares"><i class="fas fa-link"></i></a>
</h1>
<p>We have learned some basic asymptotic theory in the previous chapter. We
apply these results to study asymptotic properties of the OLS estimator
<span class="math inline">\(\widehat{\beta}=\left(X'X\right)^{-1}X'Y\)</span>, which is of key interest in
our course. We will show (i) <span class="math inline">\(\widehat{\beta}\)</span> is a consistent estimator
of the linear projection coefficient <span class="math inline">\(\beta\)</span>; (ii) <span class="math inline">\(\widehat{\beta}\)</span> is
asymptotically normal; (iii) the asymptotic normality allows asymptotic
inference of <span class="math inline">\(\beta\)</span>; (iv) under what condition the variance components
in the test statistic can be consistently estimated so that the testing
procedure is make feasible.</p>
<div id="consistency" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Consistency<a class="anchor" aria-label="anchor" href="#consistency"><i class="fas fa-link"></i></a>
</h2>
<p><em>Consistency</em> is the most basic requirement for estimators in large
sample. Intuitively, it says that when the sample size is arbitrarily
large, a desirable estimator should be arbitrarily close (in the sense
of convergence in probability) to the population quantity of interest.
Otherwise, if an estimator still deviates from the object of interest
under infinite sample size, it is hard to persuade other researchers to
use such an estimator unless compelling justification is provided.</p>
<p>For a generic estimator <span class="math inline">\(\widehat{\theta}\)</span>, we say <span class="math inline">\(\widehat{\theta}\)</span> is
<em>consistent</em> for <span class="math inline">\(\theta\)</span> if <span class="math inline">\(\widehat{\theta}\stackrel{p}{\to}\theta\)</span>,
where <span class="math inline">\(\theta\)</span> is some non-random object.</p>
<p>In OLS, we say <span class="math inline">\(\widehat{\beta}\)</span> is <em>consistent</em> if
<span class="math inline">\(\widehat{\beta}\stackrel{p}{\to}\beta\)</span> as <span class="math inline">\(n\to\infty\)</span>, where <span class="math inline">\(\beta\)</span>
is the linear projection coefficient of the population model
<span class="math inline">\(y_{i}=x_{i}'\beta+e_{i}\)</span> with <span class="math inline">\(E\left[x_{i}e_{i}\right]=0\)</span>. To verify
consistency, we write
<span class="math display">\[\widehat{\beta}-\beta=\left(X'X\right)^{-1}X'e=\left(\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\right)^{-1}\frac{1}{n}\sum_{i=1}^{n}x_{i}e_{i}.\label{eq:ols_d}\]</span></p>
<p>For simplicity, in this chapter we discuss the iid setting only. The
first term, by LLN,
<span class="math display">\[\widehat{Q}:=\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\stackrel{p}{\to}Q:=E\left[x_{i}x_{i}'\right].\]</span>
Here <span class="math inline">\(\widehat{Q}\)</span> is the sample mean of <span class="math inline">\(x_{i}x_{i}'\)</span> and <span class="math inline">\(Q\)</span> is the
population mean of <span class="math inline">\(x_{i}x_{i}'\)</span>. The second term, again by LLN,
<span class="math display">\[\frac{1}{n}\sum_{i=1}^{n}x_{i}e_{i}\stackrel{p}{\to}0.\]</span> The
continuous mapping theorem immediately implies
<span class="math display">\[\widehat{\beta}-\beta\stackrel{p}{\to}Q^{-1}\times0=0.\]</span> The OLS
estimator <span class="math inline">\(\widehat{\beta}\)</span> is a consistent estimator of <span class="math inline">\(\beta\)</span>.</p>
<p>No matter whether <span class="math inline">\(\left(y_{i},x_{i}\right)_{i=1}^{n}\)</span> is an iid, or
inid, or dependent sample, consistency holds as long as the convergence
in probability holds for the above two expressions and <span class="math inline">\(Q\)</span> is an
invertible matrix.</p>
</div>
<div id="asymptotic-distribution" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Asymptotic Distribution<a class="anchor" aria-label="anchor" href="#asymptotic-distribution"><i class="fas fa-link"></i></a>
</h2>
<p>In finite sample, <span class="math inline">\(\widehat{\beta}\)</span> is a random variable. We have shown
the distribution of <span class="math inline">\(\widehat{\beta}\)</span> under normality before. Without
the restrictive normality assumption, how can we characterize the
randomness of the OLS estimator?</p>
<p>We know from the previous section that
<span class="math inline">\(\hat{\beta}-\beta\stackrel{p}{\to}0\)</span> degenerates to a constant. To
study its distribution, we must scale it up by a proper multiplier so
that in the limit it neither degenerates nor explodes. The suitable
scaling factor is <span class="math inline">\(\sqrt{n}\)</span>, as in a CLT.
<span class="math display">\[\sqrt{n}\left(\widehat{\beta}-\beta\right)=\left(\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\right)^{-1}\frac{1}{\sqrt{n}}\sum_{i=1}^{n}x_{i}e_{i}.\]</span>
Since <span class="math inline">\(E\left[x_{i}e_{i}\right]=0\)</span>, we apply a CLT to obtain
<span class="math display">\[\frac{1}{\sqrt{n}}\sum_{i=1}^{n}x_{i}e_{i}\stackrel{d}{\to}N\left(0,\Sigma\right)\]</span>
where <span class="math inline">\(\Sigma=E\left[x_{i}x_{i}'e_{i}^{2}\right]\)</span>. By the continuous
mapping theorem,
<span class="math display">\[\sqrt{n}\left(\widehat{\beta}-\beta\right)\stackrel{d}{\to}Q^{-1}\times N\left(0,\Sigma\right)\sim N\left(0,\Omega\right)\label{eq:asym_norm}\]</span>
where <span class="math inline">\(\Omega=Q^{-1}\Sigma Q^{-1}\)</span> is called the <em>asymptotic variance</em>.
This result is the <em>asymptotic normality</em> of the OLS estimator.</p>
<p>The asymptotic variance <span class="math inline">\(\Omega=Q^{-1}\Sigma Q^{-1}\)</span> is called of the
<em>sandwich form</em>. It can be simplified under conditional homoskedasticity
<span class="math inline">\(E\left[e_{i}^{2}|x_{i}\right]=\sigma^{2}\)</span> for all <span class="math inline">\(i\)</span>, which gives
<span class="math display">\[\Sigma=E\left[x_{i}x_{i}'e_{i}^{2}\right]=E\left[x_{i}x_{i}'E\left[e_{i}^{2}|X\right]\right]=\sigma^{2}E\left[x_{i}x_{i}'\right]=\sigma^{2}Q.\]</span>
In this case, <span class="math inline">\(\Omega=Q^{-1}\Sigma Q^{-1}=\sigma^{2}Q^{-1}\)</span>, and thus
<span class="math display">\[\sqrt{n}\left(\widehat{\beta}-\beta\right)\stackrel{d}{\to}N\left(0,\sigma^{2}Q^{-1}\right).\label{eq:asym_norm_homo}\]</span></p>
<p>If we are interested in the <span class="math inline">\(k\)</span>-th parameter <span class="math inline">\(\beta_{k}\)</span>, then the joint
distribution in
(<a href="#eq:asym_norm" reference-type="eqref" reference="eq:asym_norm"><span class="math display">\[eq:asym\_norm\]</span></a>) implies <span class="math display">\[\begin{aligned}
\sqrt{n}\left(\widehat{\beta}_{k}-\beta_{k}\right) &amp; =\sqrt{n}\eta_{k}'\left(\widehat{\beta}-\beta\right)\nonumber \\
&amp; \stackrel{d}{\to}N\left(0,\sigma^{2}\eta_{k}'Q^{-1}\eta_{k}\right)\sim N\left(0,\sigma^{2}[Q^{-1}]_{kk}\right),\label{eq:asym_norm_homok}\end{aligned}\]</span>
where <span class="math inline">\(\eta_{k}=\left(0,\ldots,0,1,0\ldots,0\right)'\)</span> is the selector of
the <span class="math inline">\(k\)</span>-th element.</p>
<p>If <span class="math inline">\(\Omega^{-1/2}\)</span> is multiplied on both sides of
<a href="#eq:asym_norm" reference-type="eqref" reference="eq:asym_norm"><span class="math display">\[eq:asym\_norm\]</span></a>, we have
<span class="math display">\[\Omega^{-1/2}\sqrt{n}\left(\widehat{\beta}-\beta\right)\stackrel{d}{\to}N\left(0,I_{K}\right).\label{eq:asym_norm-pivot}\]</span>
We say the asymptotic distribution in
<a href="#eq:asym_norm-pivot" reference-type="eqref" reference="eq:asym_norm-pivot"><span class="math display">\[eq:asym\_norm-pivot\]</span></a>, <span class="math inline">\(N\left(0,I_{K}\right)\)</span>, is <em>pivotal</em>
because it does not involve any unknown parameter. In contrast, the
asymptotic distribution in
<a href="#eq:asym_norm" reference-type="eqref" reference="eq:asym_norm"><span class="math display">\[eq:asym\_norm\]</span></a> is not pivotal because <span class="math inline">\(\Omega\)</span> is unknown in
<span class="math inline">\(N\left(0,\Omega\right)\)</span>. If we are interested in the <span class="math inline">\(k\)</span>-th parameter
<span class="math inline">\(\beta_{k}\)</span>, we can write
<a href="#eq:asym_norm-pivot" reference-type="eqref" reference="eq:asym_norm-pivot"><span class="math display">\[eq:asym\_norm-pivot\]</span></a> into the pivotal form as
<span class="math display">\[\frac{\sqrt{n}\left(\widehat{\beta}_{k}-\beta_{k}\right)}{\sqrt{\sigma^{2}[Q^{-1}]_{kk}}}\stackrel{d}{\to}N\left(0,1\right).\label{eq:asym_norm_homok_pivot}\]</span></p>
</div>
<div id="asymptotic-inference" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Asymptotic Inference<a class="anchor" aria-label="anchor" href="#asymptotic-inference"><i class="fas fa-link"></i></a>
</h2>
<p>Up to now we have derived the asymptotic distribution of
<span class="math inline">\(\widehat{\beta}\)</span>. However,
<a href="#eq:asym_norm" reference-type="eqref" reference="eq:asym_norm"><span class="math display">\[eq:asym\_norm\]</span></a> or
<a href="#eq:asym_norm-pivot" reference-type="eqref" reference="eq:asym_norm-pivot"><span class="math display">\[eq:asym\_norm-pivot\]</span></a> will be useful for statistical inference
only if <span class="math inline">\(\Omega\)</span> is known. In reality <span class="math inline">\(\Omega\)</span> is mostly unknown, and
therefore we will need to estimate it to make statistical inference
feasible. Suppose <span class="math inline">\(\tilde{\Omega}\)</span> is any consistent estimator for
<span class="math inline">\(\Omega\)</span> in that <span class="math inline">\(\tilde{\Omega}\stackrel{p}{\to}\Omega\)</span>. When we
replace <span class="math inline">\(\Omega\)</span> in
<a href="#eq:asym_norm-pivot" reference-type="eqref" reference="eq:asym_norm-pivot"><span class="math display">\[eq:asym\_norm-pivot\]</span></a> with <span class="math inline">\(\tilde{\Omega}\)</span>, we have
<span class="math display">\[\begin{aligned}
\tilde{\Omega}^{-1/2}\sqrt{n}\left(\widehat{\beta}-\beta\right) &amp; =\tilde{\Omega}^{-1/2}\Omega^{1/2}\times\Omega^{-1/2}\sqrt{n}\left(\widehat{\beta}-\beta\right).\end{aligned}\]</span>
Because <span class="math inline">\(\Omega\)</span> is positive definite, we have the first factor
<span class="math inline">\(\tilde{\Omega}^{-1/2}\Omega^{1/2}\stackrel{p}{\to}I_{K}\)</span> by the
continuous mapping theorem. The second factor is asymptotic normal by
<a href="#eq:asym_norm-pivot" reference-type="eqref" reference="eq:asym_norm-pivot"><span class="math display">\[eq:asym\_norm-pivot\]</span></a>. Thus Slutsky’s theorem implies
<span class="math display">\[\tilde{\Omega}^{-1/2}\sqrt{n}\left(\widehat{\beta}-\beta\right)\stackrel{d}{\to}N\left(0,I_{K}\right)\label{eq:asym_norm_feasible}\]</span>
and
<a href="#eq:asym_norm_feasible" reference-type="eqref" reference="eq:asym_norm_feasible"><span class="math display">\[eq:asym\_norm\_feasible\]</span></a> is a feasible statistic for
asymptotic inference.</p>
<p>The next question is how to consistently estimate
<span class="math inline">\(\Omega=Q^{-1}\Sigma Q^{-1}\)</span>, or equivalent how to come up with an
<span class="math inline">\(\tilde{\Omega}\)</span>. We have had <span class="math inline">\(\widehat{Q}\stackrel{p}{\to}Q\)</span>. If we
have a consistent estimator <span class="math inline">\(\tilde{\Sigma}\)</span> for <span class="math inline">\(\Sigma\)</span>, then we can
plug in these consistent estimators to form
<span class="math inline">\(\tilde{\Omega}=\widehat{Q}^{-1}\tilde{\Sigma}\widehat{Q}^{-1}\)</span>. The
tricky question is how to consistently estimate
<span class="math inline">\(\Sigma=E\left[x_{i}x_{i}'e_{i}^{2}\right]\)</span>. We cannot use the sample
mean of <span class="math inline">\(x_{i}x_{i}'e_{i}^{2}\)</span> to estimate <span class="math inline">\(\Sigma\)</span> because <span class="math inline">\(e_{i}\)</span> is
unobservable. Under homoskedasticity
<span class="math inline">\(\Omega=Q^{-1}\Sigma Q^{-1}=\sigma^{2}Q^{-1}\)</span>, and similarly we cannot
use the sample mean of <span class="math inline">\(e_{i}^{2}\)</span> to estimate <span class="math inline">\(\sigma^{2}\)</span>.</p>
<p>Heteroskedasticity is ubiquitous in econometrics. A regression example
that naturally generates conditional heteroskedasticity is the <em>linear
probability model</em> <span class="math inline">\(y_{i}=x_{i}'\beta+e_{i}\)</span>, where
<span class="math inline">\(y_{i}\in\left\{ 0,1\right\}\)</span> is a binary dependent variable. Assume CEF
as <span class="math inline">\(E\left[y_{i}|x_{i}\right]=x_{i}'\beta\)</span>, so we can use OLS to
consistently estimate <span class="math inline">\(\beta\)</span>. The conditional variance
<span class="math display">\[\mathrm{var}\left[e_{i}|x_{i}\right]=\mathrm{var}\left[y_{i}|x_{i}\right]=E\left[y_{i}|x_{i}\right]\left(1-E\left[y_{i}|x_{i}\right]\right)=x_{i}'\beta\left(1-x_{i}'\beta\right)\]</span>
explicitly depends on <span class="math inline">\(x_{i}\)</span>. In other words, the conditional variance
varies with <span class="math inline">\(x_{i}\)</span>.</p>
<p>Naturally, one may attempt to use the OLS residual
<span class="math inline">\(\widehat{e}_{i}=\widehat{y}_{i}-x_{i}'\widehat{\beta}\)</span> to replace the
regression error <span class="math inline">\(e_{i}\)</span>, so that we would have the plug-in estimators
<span class="math inline">\(\widehat{\Omega}=\widehat{\sigma}^{2}\widehat{Q}^{-1}\)</span> for
homoskedasticity, where
<span class="math inline">\(\widehat{\sigma}^{2}=\widehat{e}'\widehat{e}/\left(n-K\right)\)</span> or
<span class="math inline">\(\widehat{\sigma}^{2}=\widehat{e}'\widehat{e}/n\)</span>, and
<span class="math inline">\(\widehat{\Omega}=\widehat{Q}^{-1}\widehat{\Sigma}\widehat{Q}^{-1}\)</span> for
heteroskedasticity, where
<span class="math inline">\(\widehat{\Sigma}=n^{-1}\sum_{i}x_{i}x_{i}'\widehat{e}_{i}^{2}\)</span>.</p>
<p>If we choose
<span class="math inline">\(\widehat{\sigma}^{2}=\widehat{e}'\widehat{e}/\left(n-K\right)\)</span> and
replace <span class="math inline">\(\sigma^{2}\)</span> in
<a href="#eq:asym_norm_homok_pivot" reference-type="eqref" reference="eq:asym_norm_homok_pivot"><span class="math display">\[eq:asym\_norm\_homok\_pivot\]</span></a>, then the resulting statistic
<span class="math inline">\(T_{k}=\frac{\sqrt{n}\left(\widehat{\beta}_{k}-\beta_{k}\right)}{\sqrt{\widehat{\sigma}^{2}[\widehat{Q}^{-1}]_{kk}}}\)</span>
is exactly the <span class="math inline">\(t\)</span>-statistic in the finite sample analysis. Recall that
under the classical normal-error assumption, the <span class="math inline">\(t\)</span>-statistics follows
exact finite sample <span class="math inline">\(t\)</span>-distribution with degrees of freedom <span class="math inline">\(n-K\)</span>. In
asymptotic analysis, we allow <span class="math inline">\(e_{i}\)</span> to be any distribution if
<span class="math inline">\(E\left[e_{i}^{2}|x_{i}\right]&lt;\infty\)</span> (We impose this assumption for
simplicity. It can be further relaxed in inid cases.) The asymptotic
normality allows us to conduct asymptotic statistical inference. For the
same <span class="math inline">\(t\)</span>-statistic, we must draw the critical values from the normal
distribution, because
<span class="math display">\[T_{k}=\frac{\sqrt{\sigma^{2}[Q^{-1}]_{kk}}}{\sqrt{\widehat{\sigma}^{2}[\widehat{Q}^{-1}]_{kk}}}\cdot\frac{\sqrt{n}\left(\widehat{\beta}_{k}-\beta_{k}\right)}{\sqrt{\sigma^{2}[Q^{-1}]_{kk}}}\stackrel{d}{\to}1\times N\left(0,1\right)\sim N\left(0,1\right)\]</span>
by Slutsky’s theorem if
<span class="math inline">\(\widehat{\sigma}^{2}\stackrel{p}{\to}\sigma^{2}\)</span>.</p>
<p>The next section will give sufficient conditions for
<span class="math inline">\(\widehat{\sigma}^{2}\stackrel{p}{\to}\sigma^{2}\)</span> and
<span class="math inline">\(\widehat{\Sigma}\stackrel{p}{\to}\Sigma\)</span>.</p>
</div>
<div id="consistency-of-feasible-variance-estimator" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> Consistency of Feasible Variance Estimator<a class="anchor" aria-label="anchor" href="#consistency-of-feasible-variance-estimator"><i class="fas fa-link"></i></a>
</h2>
<p>We first show under what conditions all elements of
<span class="math inline">\(\Sigma=E\left[x_{i}x_{i}'e_{i}^{2}\right]\)</span> are finite. That is,
<span class="math inline">\(\left\Vert \Sigma\right\Vert _{\infty}&lt;\infty\)</span>, where
<span class="math inline">\(\left\Vert \cdot\right\Vert _{\infty}\)</span> is the value of the largest
element in absolute value of a matrix or vector. Let <span class="math inline">\(z_{i}=x_{i}e_{i}\)</span>,
so <span class="math inline">\(\Sigma=E\left[z_{i}z_{i}'\right]\)</span>.</p>
<p>For a generic random variable <span class="math inline">\(u_{i}\)</span> with finite variance, define its
<span class="math inline">\(L_{2}\)</span><em>-norm</em> as <span class="math inline">\(\sqrt{E\left[u_{i}^{2}\right]}\)</span>. Given another
generic random variable <span class="math inline">\(v_{i}\)</span> with finite variance, define the <em>inner
product</em> of <span class="math inline">\(u_{i}\)</span> and <span class="math inline">\(v_{i}\)</span> as <span class="math inline">\(E\left[u_{i}v_{i}\right]\)</span>.</p>
<p><span class="math inline">\(\left|E\left[u_{i}v_{i}\right]\right|\leq\sqrt{E\left[u_{i}^{2}\right]E\left[v_{i}^{2}\right]}\)</span>.</p>
<p>Because of the Cauchy-Schwarz inequality (cross moments are no larger
than variance)
<span class="math display">\[\left\Vert \Sigma\right\Vert _{\infty}=\max_{k\in[K]}E\left[z_{ik}^{2}\right],\]</span>
where <span class="math inline">\(\left[K\right]:=\left\{ 1,2,\ldots,K\right\}\)</span>. For each <span class="math inline">\(k\)</span>,
<span class="math display">\[E\left[z_{ik}^{2}\right]=E\left[x_{ik}^{2}e_{i}^{2}\right]\leq\left(E\left[x_{ik}^{4}\right]E\left[e_{i}^{4}\right]\right)^{1/2}\]</span>
where the last inequality again follows by the Cauchy-Schwarz
inequality. It implies that the <em>sufficient conditions</em> for finite
variance are
<span class="math display">\[\max_{k}E\left[x_{ik}^{4}\right]&lt;\infty\ \ \mbox{and }\ \ E\left[e_{i}^{4}\right]&lt;\infty.\label{eq:4th_moment}\]</span>
We will maintain these conditions in the following derivation.</p>
<div id="homoskedasticity" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> Homoskedasticity<a class="anchor" aria-label="anchor" href="#homoskedasticity"><i class="fas fa-link"></i></a>
</h3>
<p>For the estimation of variance, if the error is homoskedastic,
<span class="math display">\[\begin{aligned}\frac{1}{n}\sum_{i=1}^{n}\widehat{e}_{i}^{2} &amp; =\frac{1}{n}\sum_{i=1}^{n}\left(e_{i}+x_{i}'\left(\widehat{\beta}-\beta\right)\right)^{2}\\
&amp; =\frac{1}{n}\sum_{i=1}^{n}e_{i}^{2}+\left(\frac{2}{n}\sum_{i=1}^{n}e_{i}x_{i}\right)'\left(\widehat{\beta}-\beta\right)+\frac{1}{n}\sum_{i=1}^{n}\left(\widehat{\beta}-\beta\right)'x_{i}x_{i}'\left(\widehat{\beta}-\beta\right).
\end{aligned}
\label{eq:v-homo1}\]</span></p>
<p>For a generic <span class="math inline">\(m\)</span>-vector <span class="math inline">\(u\)</span>, define its <span class="math inline">\(L_{2}\)</span><em>-norm</em> as
<span class="math inline">\(\left\Vert u\right\Vert _{2}=\sqrt{u'u}\)</span>. Given another generic
<span class="math inline">\(m\)</span>-vector <span class="math inline">\(v\)</span>, define the <em>inner product</em> of <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> as
<span class="math inline">\(\left\langle u,v\right\rangle =u'v\)</span>.</p>
<p><span class="math inline">\(\left|\left\langle u,v\right\rangle \right|\leq\left\Vert u\right\Vert _{2}\left\Vert v\right\Vert _{2}\)</span>,
or equivalently
<span class="math inline">\(\left|u'v\right|\leq\sqrt{\left(u'u\right)\left(v'v\right)}\)</span>.</p>
<p>Notice
<span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n}e_{i}x_{i}\stackrel{p}{\to}E\left[e_{i}x_{i}\right]=0\)</span>,
the second term of <a href="#eq:v-homo1" reference-type="eqref" reference="eq:v-homo1"><span class="math display">\[eq:v-homo1\]</span></a> is <span class="math display">\[\begin{aligned}
\left|\left(\frac{2}{n}\sum_{i=1}^{n}e_{i}x_{i}\right)'\left(\widehat{\beta}-\beta\right)\right| &amp; \leq2\left\Vert \frac{1}{n}\sum_{i=1}^{n}x_{i}e_{i}\right\Vert _{2}\left\Vert \widehat{\beta}-\beta\right\Vert _{2}\nonumber \\
&amp; =o_{p}\left(1\right)o_{p}\left(1\right)=o_{p}\left(1\right)\label{eq:homo1}\end{aligned}\]</span>
by Cauchy-Schwarz inequality.</p>
<p>For a generic <span class="math inline">\(m\times m\)</span> symmetric positive semi-definite matrix <span class="math inline">\(A\)</span>
and a generic <span class="math inline">\(m\)</span> vector <span class="math inline">\(u\)</span>, we have the
<span class="math display">\[\left\Vert u\right\Vert _{2}^{2}\lambda_{\min}\left(A\right)\leq u'Au\leq\left\Vert u\right\Vert _{2}^{2}\lambda_{\max}\left(A\right).\]</span></p>
<p>The third term of <a href="#eq:v-homo1" reference-type="eqref" reference="eq:v-homo1"><span class="math display">\[eq:v-homo1\]</span></a> is bounded by <span class="math display">\[\begin{aligned}
\left(\widehat{\beta}-\beta\right)\left(\frac{1}{n}\sum_{i=1}^{n}e_{i}^{2}x_{i}x'_{i}\right)\left(\widehat{\beta}-\beta\right) &amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}\lambda_{\max}\left(\frac{1}{n}\sum_{i=1}^{n}x_{i}x'_{i}\right)\nonumber \\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}\mathrm{trace}\left(\frac{1}{n}\sum_{i=1}^{n}x_{i}x'_{i}\right)\nonumber \\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}K\max_{k}\left\{ \frac{1}{n}\sum_{i=1}^{n}x_{ik}^{2}\right\} \nonumber \\
&amp; =o_{p}\left(1\right)O_{p}\left(1\right)=o_{p}\left(1\right),\label{eq:homo2}\end{aligned}\]</span>
where the stochastic order follows by
<span class="math display">\[\frac{1}{n}\sum_{i=1}^{n}x_{ik}^{2}\stackrel{p}{\to}E\left[x_{ik}^{2}\right]&lt;\infty\]</span>
in view of the condition
<a href="#eq:4th_moment" reference-type="eqref" reference="eq:4th_moment"><span class="math display">\[eq:4th\_moment\]</span></a>.</p>
<p>(<a href="#eq:homo1" reference-type="ref" reference="eq:homo1"><span class="math display">\[eq:homo1\]</span></a>)
and (<a href="#eq:homo2" reference-type="ref" reference="eq:homo2"><span class="math display">\[eq:homo2\]</span></a>) implies that
<span class="math display">\[\frac{1}{n}\sum_{i=1}^{n}\widehat{e}_{i}^{2}=\frac{1}{n}\sum_{i=1}^{n}e_{i}^{2}+o_{p}\left(1\right)+o_{p}\left(1\right)=\frac{1}{n}\sum_{i=1}^{n}e_{i}^{2}+o_{p}\left(1\right)\stackrel{p}{\to}\sigma_{e}^{2}.\]</span>
(See Appendix for the operations of small op and big Op.)</p>
</div>
<div id="heteroskedasticity" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Heteroskedasticity<a class="anchor" aria-label="anchor" href="#heteroskedasticity"><i class="fas fa-link"></i></a>
</h3>
<p>The basic strategy of proof is similar for the general case of
heteroskedasticity, though each step is more complicated.
<span class="math display">\[\begin{aligned}\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\widehat{e}_{i}^{2} &amp; =\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\left(e_{i}+x_{i}'\left(\widehat{\beta}-\beta\right)\right)^{2}\\
&amp; =\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'e_{i}^{2}+\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\cdot e_{i}x_{i}'\left(\widehat{\beta}-\beta\right)+\frac{1}{n}\sum_{i=1}^{n}x_{i}x_{i}'\left(\left(\widehat{\beta}-\beta\right)'x_{i}\right)^{2}.
\end{aligned}
\label{eq:v-hetero}\]</span></p>
<p>For a generic <span class="math inline">\(m\)</span>-vector <span class="math inline">\(u\)</span>, its <span class="math inline">\(L_{p}\)</span>-norm (for <span class="math inline">\(p\geq1\)</span>) is defined
as
<span class="math inline">\(\left\Vert u\right\Vert _{p}=\left(\left|u_{1}\right|^{p}+\cdots+\left|u_{m}\right|^{p}\right)^{1/p}\)</span>.</p>
<p>For two generic <span class="math inline">\(m\)</span>-vectors <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>,
<span class="math display">\[\left|u'v\right|\leq\left\Vert u\right\Vert _{p}\left\Vert q\right\Vert _{q}\]</span>
for any <span class="math inline">\(p,q\in[1,\infty)\)</span> and <span class="math inline">\(1/p+1/q=1\)</span>.</p>
<p>Cauchy-Schwarz inequality is a special case of Holder’s inequality when
<span class="math inline">\(p=q=2\)</span>.</p>
<p>The second term of
<a href="#eq:v-hetero" reference-type="eqref" reference="eq:v-hetero"><span class="math display">\[eq:v-hetero\]</span></a> is bounded by
<span class="math display">\[\begin{aligned} &amp; \max_{k,k'}\left|\frac{1}{n}\sum_{i=1}^{n}x_{ik}x_{ik'}\cdot e_{i}x_{i}'\left(\widehat{\beta}-\beta\right)\right|\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}\max_{k,k'}\left\Vert \frac{1}{n}\sum_{i=1}^{n}x_{i}e_{i}x_{ik}x_{ik'}\right\Vert _{2}\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}\sqrt{K}\max_{k,k',k''}\left|\frac{1}{n}\sum_{i=1}^{n}e_{i}x_{ik}x_{ik'}x_{ik''}\right|\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}\sqrt{K}\left(\frac{1}{n}\sum_{i=1}^{n}e_{i}^{4}\right)^{1/4}\max_{k,k',k''}\left(\frac{1}{n}\sum_{i=1}^{n}\left(x_{ik}x_{ik'}x_{ik''}\right)^{4/3}\right)^{3/4}\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}\sqrt{K}\left(\frac{1}{n}\sum_{i=1}^{n}e_{i}^{4}\right)^{1/4}\max_{k}\left(\frac{1}{n}\sum_{i=1}^{n}x_{ik}^{4}\right)^{3/4}\\
&amp; =o_{p}\left(1\right)O_{p}\left(1\right)O_{p}\left(1\right)=o_{p}\left(1\right)
\end{aligned}\]</span> where the third inequality hold by the Holder’s
inequality with <span class="math inline">\(p=4\)</span> and <span class="math inline">\(q=4/3\)</span>, and the stochastic order is
guaranteed if under suitable conditions
<span class="math display">\[\frac{1}{n}\sum_{i=1}^{n}e_{i}^{4}\stackrel{p}{\to}E\left[e_{i}^{4}\right]&lt;\infty\ \ \text{and }\ \ \frac{1}{n}\sum_{i=1}^{n}x_{ik}^{4}\stackrel{p}{\to}E\left[x_{ik}^{4}\right]&lt;\infty.\]</span></p>
<p>The third term of <a href="#eq:v-hetero" reference-type="eqref" reference="eq:v-hetero"><span class="math display">\[eq:v-hetero\]</span></a> is bounded by
<span class="math display">\[\begin{aligned} &amp; \max_{k_{1},k_{2}}\left|\frac{1}{n}\sum_{i=1}^{n}x_{ik_{1}}x_{ik_{2}}\left(\left(\widehat{\beta}-\beta\right)'x_{i}\right)^{2}\right|\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}\max_{k_{1},k_{2}}\left|\frac{1}{n}\sum_{i=1}^{n}x_{ik_{1}}x_{ik_{2}}\left(x_{i}x_{i}'\right)\right|\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}\max_{k_{1},k_{2},k_{3},k_{4}}\left|\frac{1}{n}\sum_{i=1}^{n}x_{ik_{1}}x_{ik_{2}}x_{ik_{3}}x_{ik_{4}}\right|\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}\max_{k_{1},k_{2}}\left|\frac{1}{n}\sum_{i=1}^{n}x_{ik_{1}}^{2}x_{ik_{2}}^{2}\right|\\
&amp; \leq\left\Vert \widehat{\beta}-\beta\right\Vert _{2}^{2}\max_{k}\left|\frac{1}{n}\sum_{i=1}^{n}x_{ik}^{4}\right|\\
&amp; =o_{p}\left(1\right)O_{p}\left(1\right)=o_{p}\left(1\right).
\end{aligned}\]</span> where the third and the fourth inequalities follow by
applying Cauchy Schwarz inequality.</p>
</div>
</div>
<div id="summary-5" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Summary<a class="anchor" aria-label="anchor" href="#summary-5"><i class="fas fa-link"></i></a>
</h2>
<p>One of the most important techniques in asymptotic theory is
manipulating inequalities. These derivations of the variances look
complicated at first glance, but is often encountered in proofs of
theoretical results. After many years of torment, you will be accustomed
to these routine calculations.</p>
<p><strong>Historical notes</strong>: <span class="citation">White (<a href="generalized-method-of-moments.html#ref-white1980heteroskedasticity" role="doc-biblioref">1980</a>)</span> drew attention of
economic contexts that violate the classical statistical assumptions in
linear regressions. It seeded econometricians’ care, or obsession, in
variance estimation for statistical inference. The following decades has
witnessed a plethora of proposals of variance estimation that deal with
various deviation from the classical assumptions.</p>
<p><strong>Further reading</strong>: In this chapter all vectors are of finite
dimensional. Some results can be extended to allow infinite <span class="math inline">\(K\)</span> when
<span class="math inline">\(K\to\infty\)</span> at a much slower speed than <span class="math inline">\(n\)</span>. Such asymptotic
development will require multiple indices, and it goes beyond the
simplest case of <span class="math inline">\(n\to\infty\)</span> that we learned here. Big data is
accompanied by big model, in which the model itself is indexed by the
sample size and can grow more sophisticated as <span class="math inline">\(n\)</span> get bigger. In the
proofs of my latest paper <span class="citation">Shi, Su, and Xie (<a href="generalized-method-of-moments.html#ref-shi2020high" role="doc-biblioref">2020</a>)</span>, You will find loads of
inequality operations of similar flavor to this chapter.</p>
</div>
<div id="appendix-1" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Appendix<a class="anchor" aria-label="anchor" href="#appendix-1"><i class="fas fa-link"></i></a>
</h2>
<p>We introduce the “big Op and small op” notation. They are the stochastic
counterparts of the “big O and small o” notation in deterministic cases.</p>
<ul>
<li><p>Small op: <span class="math inline">\(x_{n}=o_{p}\left(r_{n}\right)\)</span> if
<span class="math inline">\(x_{n}/r_{n}\stackrel{p}{\to}0\)</span>.</p></li>
<li><p>Big Op: <span class="math inline">\(x_{n}=O_{p}\left(r_{n}\right)\)</span> if for any <span class="math inline">\(\varepsilon&gt;0\)</span>,
there exists a <span class="math inline">\(c&gt;0\)</span> such that
<span class="math inline">\(P\left(\left|x_{n}\right|/r_{n}&gt;c\right)&lt;\varepsilon\)</span>.</p></li>
</ul>
<p>Some operations:</p>
<ul>
<li><p><span class="math inline">\(o_{p}\left(1\right)+o_{p}\left(1\right)=o_{p}\left(1\right)\)</span>;</p></li>
<li><p><span class="math inline">\(o_{p}\left(1\right)+O_{p}\left(1\right)=O_{p}\left(1\right)\)</span>;</p></li>
<li><p><span class="math inline">\(o_{p}\left(1\right)O_{p}\left(1\right)=o_{p}\left(1\right)\)</span>.</p></li>
</ul>
<p>The big Op and small op notation allows us to keep using equalities in
calculation while expressing the stochastic order of random objects.</p>
<p><code>Zhentao Shi. Oct 21, 2020.</code></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="basic-asymptotic-theory.html"><span class="header-section-number">6</span> Basic Asymptotic Theory</a></div>
<div class="next"><a href="asymptotic-properties-of-mle.html"><span class="header-section-number">8</span> Asymptotic Properties of MLE</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#asymptotic-properties-of-least-squares"><span class="header-section-number">7</span> Asymptotic Properties of Least Squares</a></li>
<li><a class="nav-link" href="#consistency"><span class="header-section-number">7.1</span> Consistency</a></li>
<li><a class="nav-link" href="#asymptotic-distribution"><span class="header-section-number">7.2</span> Asymptotic Distribution</a></li>
<li><a class="nav-link" href="#asymptotic-inference"><span class="header-section-number">7.3</span> Asymptotic Inference</a></li>
<li>
<a class="nav-link" href="#consistency-of-feasible-variance-estimator"><span class="header-section-number">7.4</span> Consistency of Feasible Variance Estimator</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#homoskedasticity"><span class="header-section-number">7.4.1</span> Homoskedasticity</a></li>
<li><a class="nav-link" href="#heteroskedasticity"><span class="header-section-number">7.4.2</span> Heteroskedasticity</a></li>
</ul>
</li>
<li><a class="nav-link" href="#summary-5"><span class="header-section-number">7.5</span> Summary</a></li>
<li><a class="nav-link" href="#appendix-1"><span class="header-section-number">7.6</span> Appendix</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/zhentaoshi/Econ5121A/blob/master/06-lecture.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/zhentaoshi/Econ5121A/edit/master/06-lecture.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Econ5121</strong>" was written by Zhentao Shi. It was last built on 2022-06-12.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
